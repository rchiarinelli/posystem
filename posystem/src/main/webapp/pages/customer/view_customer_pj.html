<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1" />
<script type="text/javascript">
	dojo.require("dojo.html");
	dojo.require("dijit.form.Textarea");

	dojo.addOnLoad(function(){
		if (checkURL()){
			loadCustomer();			

		} else {
			openPage('mainContent','/pages/customer/filter_customer.html');
		}
	});


	function checkURL(){
		var customerId = dojo.getObject('customerId');
		if (customerId==null || customerId==''){
			return false;
		}
		return true;			
	}
	
	function loadCustomer() {
		var customerId = dojo.getObject('customerId');

		var url=dojo.getObject("basePath") + "/services/" + dojo.getObject("subscriber") + "/pjcustomer/get/" + customerId;
		dojo.xhrGet({
            url: url,
            headers: {
                "Content-Type": "text/plain"
            },
            handleAs: "json",
            load: function(response,args){
                console.log(response);
                var viewBeanResponse = response.serviceResponse.viewBean;
                
				if (response.serviceResponse.status.$=='0'){
					
	                dojo.html.set(dojo.byId("name"), viewBeanResponse.name.$,{	parseContent: true	});

	                
	                if (viewBeanResponse.cnpjCgc!=null && viewBeanResponse.cnpjCgc.$!='') {
		                dojo.html.set(dojo.byId("cnpj"), viewBeanResponse.cnpjCgc.$,{	parseContent: true	});	                	
	                }

	                
					if (viewBeanResponse.details!=null
							&& viewBeanResponse.details.$!=null) {
		                dojo.byId('details').value=unescape(viewBeanResponse.details.$);						
					}
					//Addresses
					if (viewBeanResponse.addresses!=null) {
						var address = viewBeanResponse.addresses;
						if (address.street!=null && address.street!='') {
							dojo.html.set(dojo.byId('street'), address.street.$,{parseContent:true});	
						}
						if (address.number!=null && address.number!=null) {
							dojo.html.set(dojo.byId('number'), address.number.$,{parseContent:true});	
						}
						if (address.complement!=null && address.complement!=null) {
							dojo.html.set(dojo.byId('complement'), address.complement.$,{parseContent:true});	
						}
						if (address.city!=null && address.city!='') {
							dojo.html.set(dojo.byId('city'), address.city.$,{parseContent:true});	
						}
						if (address.cep!=null && address.cep!=''){
							dojo.html.set(dojo.byId('cep'), address.cep.$,{parseContent:true});	
						}
						if (address.state!=null && address.state!='') {
							dojo.html.set(dojo.byId('state'), address.state.$,{parseContent:true});							
						}
					}
					
					//Contacts
					if (viewBeanResponse.contacts!=null) {
						var contact = viewBeanResponse.contacts;
						if (contact.email!=null && contact.email!='') {
							dojo.html.set(dojo.byId('email'), contact.email.$,{parseContent:true});
						}
						if (contact.officePhoneNumber!=null && contact.officePhoneNumber!='') {
							dojo.html.set(dojo.byId('officePhoneNumber'), contact.officePhoneNumber.$,{parseContent:true});							
						}
						if (contact.mobilePhoneNumber!=null && contact.mobilePhoneNumber!='') {
							dojo.html.set(dojo.byId('mobilePhoneNumber'), contact.mobilePhoneNumber.$,{parseContent:true});							
						}
					}
					
				}else if (response.serviceResponse.status.$=='1'){
					showMessages(response.serviceResponse.message.$);
				}
            },
            // if any error occurs, it goes here:
            error: function(error,args){
                console.warn("error!",error);
            }
        });		
	}
	
	function editCustomer() {
		openPage('mainContent','/pages/customer/edit_customer_pj.html');
	}
	
</script>
</head>
<body>
<div id="wrap">
	<div class="content">
		<h3>Dados do cliente pessoa jur&iacute;dica</h3>

		<div id="messages"></div>					
		<form action="#" method="post" id="viewCustomerForm">
			<p>
				<br/>
				<label for="name">Nome:</label>
				<span id="name"></span>
			</p>
			<p>
				<label for="cnpj">CNPJ:</label>
				<span id="cnpj"></span>
			</p>
			<p>
				<label for="details">Informa&ccedil;&otilde;es:</label><br />
				<textarea id="details" name="details" dojoType="dijit.form.Textarea"
					 cols="50"
					 rows="20"
					 style="height: 100px;" 
					 maxLength="999"
					 title="Dados gerais. Aceita mais de uma linha." readonly="readonly"></textarea>	
			</p>						
            <p>
            	<label for="street">Rua:</label>
				<span id="street"></span>
            </p>
            <p>
            	<label for="number">N&uacute;mero:</label>
            	<span id="number"></span>
            </p>
            <p>
            	<label for="complement">Complemento:</label>
            	<span id="complement"></span>
            </p>
            <p>
            	<label for="city">Cidade:</label>
            	<span id="city"></span>
            </p>
            <p>
            	<label for="zipcode">CEP:</label>
            	<span id="zipcode"></span>
            </p>
            <p>
            	<label for="state">Estado:</label>
            	<span id="state"></span>
            </p>
            <p>
            	<label for="email">Email:</label>
            	<span id="email"></span>
            </p>
            <p>
            	<label for=officePhoneNumber>Telefone:</label>
            	<span id="officePhoneNumber"></span>
            </p>
            <p>
            	<label for="mobilePhoneNumber">Celular:</label>
            	<span id="mobilePhoneNumber"></span>
            </p>
			<p>
				<input type="button" id="back" name="back" class="formbutton" value="Voltar" onclick="openPage('mainContent','/pages/customer/filter_customer.html');"/>
				<input type="button" id="edit" name="edit" class="formbutton" value="Editar" onclick="editCustomer();"/>
				<input type="button" id="delete" name="delete" class="formbutton" value="Apagar" onclick="openPage('mainContent','/pages/customer/delete_customer_pj.html');"/>
			</p>
		</form>
	</div>
</div>
</body>
</html>
